@model IEnumerable<AdminPureGold.Domain.Models.Mrc.PrintExportNewsletter>

@{
    ViewBag.Title = "Export";
}
@section header{
    <h2>Print Job Export Status</h2>
}

<section class="col-lg-12 col-md-12">
    <table id="topTable" class="table table-condensed table-responsive">
        <tr>
            <td>
                <h4><strong>Your Print Job Was Successfully Exported</strong></h4>
                @if (ViewBag.WordCount == 0)
                {
                    var rowCount = ViewBag.ExcelCount + 1;
                    <div class="h5 shadow-on-text padding-bottom-8">Click the Excel Icon Below To Generate Your Excel Worksheet.</div>
                    <div class="h5 shadow-on-text">This Worksheet Will Contain @ViewBag.ExcelCount Customers Or @rowCount Rows, Including Column Headers.</div>
                }
                else
                {
                    <div class="h5 shadow-on-text padding-bottom-8">Hover over the Word Icon Below And Choose The Appropriate Mail Merge Document From The Directory Provided.</div>
                    <div class="h5 shadow-on-text">The Mail Merge Will Produce @ViewBag.WordCount Customers.</div>
                }
                <table>
                    <tr>
                        <td>
                            @if (ViewBag.WordCount == 0)
                            {
                                <img id="btnExport" src="~/Images/excel.jpg" title="Export Data To Excel" class="pg-tooltip" alt="" />
                            }
                            else
                            {
                                <img id="MailMergeBtn" src="~/Images/word.png" title="S:\Weichert Co\Pure Gold" class="pg-tooltip" alt="" />
                            }
                        </td>
                        <td>
                            &nbsp;&nbsp;&nbsp;
                        </td>
                        <td>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        </td>
                        <td>
                            @using (Html.BeginForm("MarkAsSuccessful", "PrintJob", new { printJobId = ViewBag.PrintJobId }, FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-group-xs btn-primary">Mark As Successful</button>
                            }
                        </td>
                    </tr>
                </table>
            </td>

        </tr>
    </table>
</section>
<section class="col-lg-12 col-md-12">
    <table id="dvData" class="table table-condensed table-responsive">
        <tr>
            <th>Associate1LastName</th>
            <th>Associate1Name</th>
            <th>Associate2Name</th>
            <th>OfficeName</th>
            <th>OfficeAddress</th>
            <th>OfficeCity</th>
            <th>OfficeState</th>
            <th>OfficeZip</th>
            <th>OfficePhone</th>
            <th>AssociateCell</th>
            <th>AssociateEmail</th>
            <th>Envelope</th>
            <th>Address1</th>
            <th>Address2</th>
            <th>City</th>
            <th>State</th>
            <th>ZipCode</th>
        </tr>
        @if (Model.Any())
        {
            foreach (var printExportNewsletter in Model)
            {
                <tr>
                    <td>@printExportNewsletter.Associate1LastName</td>
                    <td>@printExportNewsletter.Associate1Name</td>
                    <td>@printExportNewsletter.Associate2Name</td>
                    <td>@printExportNewsletter.OfficeName</td>
                    <td>@printExportNewsletter.OfficeAddress</td>
                    <td>@printExportNewsletter.OfficeCity</td>
                    <td>@printExportNewsletter.OfficeState</td>
                    <td>@printExportNewsletter.OfficeZip</td>
                    <td>@printExportNewsletter.OfficePhone</td>
                    <td>@printExportNewsletter.AssociateCell</td>
                    <td>@printExportNewsletter.AssociateEmail</td>
                    <td>@printExportNewsletter.Envelope</td>
                    <td>@printExportNewsletter.Address1</td>
                    <td>@printExportNewsletter.Address2</td>
                    <td>@printExportNewsletter.City</td>
                    <td>@printExportNewsletter.State</td>
                    <td>@printExportNewsletter.ZipCode</td>

                </tr>
            }
        }
    </table>
</section>

<br />
@section scripts
{
    <script src="~/Scripts/jquery/plugins/jquery.battatech.excelexport.min.js"></script>
    <script src="~/Scripts/custom/printjob_export.js"></script>
}
@section styles
{
    <link href="~/Content/custom/printjob_export.css" rel="stylesheet" />
}